<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    {% extends "news/news.html" %}
    {%load static%}
</head>
<body>
{%block body%}
<div class="container2">
    <div class="column1">
        <div class="block">
            <div class="user-avatar">
                <img src="{{user.avatar.url}}">
            </div>
            {%if owner%}
            <a href="{%url 'redact' user.username%}" class="button-href muted-button">Redact</a>
            {%else%}
            <a href class="button-href blue-button2"><!Ссылка на сообщения>
                Send message
            </a>
            <br>
            {%if request.user in friends%}
            <a href="{%url 'add_friend' username=user.username operation='remove'%}" class="button-href blue-button2">
                Remove friend
            </a>
            {%else%}
            <a href="{%url 'add_friend' username=user.username operation='add'%}" class="button-href blue-button2">
                Add friend
            </a>
            {%endif%}
            {%endif%}
        </div>

        {%if request.user in friends or not user.closed or owner%}
        <div class="block" style="text-align:left;">
            <span>
                Friends <label style="color:grey">{{friends.count}}</label>
            </span>

            <div class="friend-list">
                {%for friend in friends%}
                <a href="{%url 'profile' friend.username%}" class="blue-underline-href image-href">
                    <img src="{{friend.avatar.url}}">
                    {{friend.first_name}}
                </a>
                {%endfor%}
            </div>
            {%if not owner%}
            {%if common_friends%}
            <span>
                Common friends <label style="color:grey">{{common_friends|length}}</label>
            </span>


            <div class="friend-list">
                {%for friend in common_friends%}
                <a href="{%url 'profile' friend.username%}" class="blue-underline-href image-href">
                    <img src="{{friend.avatar.url}}">
                    {{friend.first_name}}
                </a>
                {%endfor%}
            </div>
            {%endif%}
            {%endif%}
        </div>
        {%endif%}

        {%if request.user in friends or not user.closed or owner%}
        <div class="block" style="text-align:left;">
            <span>Subscribe <label style="color:grey">46</label></span>
            <!цикл>
            <div class="row1">
                <a href class="image-href">
                    <img src="{%static 'images/user.jpg'%}">
                </a>
                <div class="group-small-info">
                    <a href class="blue-underline-href">
                        Картинки категории Б
                    </a>
                    <span style="color:grey">Шутим как можем </span>
                </div>

            </div>
            <div class="row1">
                <a href class="image-href">
                    <img src="{%static 'images/user.jpg'%}">
                </a>
                <div class="group-small-info">
                    <a href class="blue-underline-href">
                        Картинки категории Б
                    </a>
                    <span style="color:grey">Шутим как можем </span>
                </div>

            </div>
            <div class="row1">
                <a href class="image-href">
                    <img src="{%static 'images/user.jpg'%}">
                </a>
                <div class="group-small-info">
                    <a href class="blue-underline-href">
                        Картинки категории Б
                    </a>
                    <span style="color:grey">Шутим как можем </span>
                </div>

            </div>

        </div>
        {%endif%}
    </div>

    <div class="column2">
        <div class="block">
            <div class="profile-current-info">

                <div>
                    <span style="font-size:26px;">{{user.first_name}} {{user.last_name}}</span>
                    <label>{{time_delta}}</label>
                </div>
                <span>
                    {%if user.current_info%}
                        {{user.current_info}}
                    {%endif%}
                </span>
            </div>

            <div class="profile-info bottom-line top-line" style="padding-top:5px;">
                <span>
                    Birthday:
                </span>
                <label>{{user.birthday}}</label>
            </div>

            {%if user.city%}
            <div class="profile-info bottom-line">
                <span>
                    City:
                </span>
                <label>{{user.city}}</label>
            </div>
            {%endif%}

            {%if user.phone_number%}
            <div class="profile-info bottom-line">
                <span>
                    Phone number:
                </span>
                <label>{{user.phone_number}}</label>
            </div>
            {%endif%}

            {%if user.work%}
            <div class="profile-info bottom-line">
                <span>
                    Work:
                </span>
                <label>{{user.work}}</label>
            </div>
            {%endif%}

            {%if user.study%}
            <div class="profile-info bottom-line">
                <span>
                    Education:
                </span>
                <label>{{user.study}}</label>
            </div>
            {%endif%}


            <div class="profile-buttons">
                <a class="page-counter" href>
                    <div class="counter">
                        {{friends.count}}
                    </div>
                    <label>
                        friends
                    </label>
                </a>

                <a class="page-counter" href>
                    <div class="counter">
                        7
                    </div>
                    <label>
                        photos
                    </label>
                </a>
                <a class="page-counter" href>
                    <div class="counter">
                        46
                    </div>
                    <label>
                        groups
                    </label>
                </a>
            </div>
        </div>

        {%if request.user in friends or not user.closed or owner%}
        <div class="block">
            <div class="small-info">
                My photos
                <span>7</span>
            </div>

            <div>
                <!цикл>
                <a href class="medium-image-href">
                    <img src="{%static 'images/user.jpg'%}">
                </a>
                <a href class="medium-image-href">
                    <img src="{%static 'images/user.jpg'%}">
                </a>
                <a href class="medium-image-href">
                    <img src="{%static 'images/user.jpg'%}">
                </a>
                <a href class="medium-image-href">
                    <img src="{%static 'images/user.jpg'%}">
                </a>
            </div>
        </div>

        {%if owner%}
        <div class="block">
            <a href="{%url 'add_note'%}" class="blue-underline-href">+ Add note</a>
        </div>
        {% endif%}

        {%for note in notes%}
        <div class="block">
            <div class="post-header">
                <div style="display:flex;">
                    <a href="{%url 'profile' user%}" class="image-href">
                        <img src="{{user.avatar.url}}">
                    </a>
                    <a href="{%url 'profile' user%}" class="blue-underline-href"
                       style="margin-top:20px; margin-left:10px;">
                        <span>{{user.first_name}} {{user.last_name}}</span>
                    </a>
                </div>

                <span style="color:grey">
                    {{note.post_time}}
                </span>
            </div>
            <div class="post-container">
                <label>
                    {{note.text}}
                </label>
                {%if note.image1%}
                <div style="display:flex">
                    {%if note.image2%}
                    <img class="post-image1" src="{{note.image1.url}}">
                    {%else%}
                    <img class="post-image1-wide" src="{{note.image1.url}}">
                    {%endif%}
                    <div>
                        {%if note.image2%}
                        <img class="post-image2" style="margin-bottom:0px; margin-top:0px;" src="{{note.image2.url}}">
                        {%if note.image3%}
                        <img class="post-image2" style="margin-top:7px" src="{{note.image3.url}}">
                        {%endif%}
                        {%endif%}
                    </div>

                </div>
                {%endif%}
            </div>

            <div class="post-buttons top-line bottom-line">
                <a href="{%url 'like' note.pk 'profile' user.username%}" class="post-button">

                    {%if request.user.id in note.liked %}
                    <i class="fa fa-heart" aria-hidden="true" style="color:#ff0000"></i>
                    <span style="color:#ff0000">{{note.like_set.all.count}}</span>
                    {%else%}
                    <i class="fa fa-heart-o" aria-hidden="true"></i>
                    <span>{{note.like_set.all.count}}</span>
                    {%endif%}


                </a>

                <a href="" class="post-button">
                    <i class="fa fa-comment-o post-button" aria-hidden="true"></i>
                    <span>
                        {%if note.comment_set.count%}
                            {{note.comment_set.count}}
                        {%endif%}
                    </span>
                </a>

                <a href="" class="post-button">
                    <i class="fa fa-share post-button" aria-hidden="true"></i>
                </a>
            </div>

            <div class="comments-container">
                {%for comment in note.comment_set.all%}
                <div class="comment-header">
                    <div style="display:flex;">
                        <a href="{%url 'profile' comment.author%}" class="image-href-small">
                            <img src="{{comment.author.avatar.url}}">
                        </a>
                        <a href="{%url 'profile' comment.author%}" class="blue-underline-href"
                           style="margin-top:10px; margin-left:-20px;">
                            <span>{{comment.author.first_name}} {{comment.author.last_name}}</span>
                        </a>
                    </div>
                    <span style="color:grey">
                        {{comment.post_time}}
                    </span>
                </div>

                <div class="comment-body">
                    <span>
                       {{comment.text}}
                    </span>
                    {%if comment.image%}
                    <img src="{{comment.image.url}}">
                    {%endif%}
                </div>
                {%endfor%}
            </div>
            {%if note.can_comment%}
            <div class="leave-comment top-line">
                <form class="comment-form" method="post" enctype="multipart/form-data">
                    {%csrf_token%}
                    <input class="comment-input" type="text" placeholder="Leave comment" name="text" id="text">

                    <label class="label border-right">
                        <span class="title">
                            <i class="fa fa-camera" aria-hidden="true"></i>
                        </span>
                        <input class="invisible" type="file" name="img" id="img">
                    </label>

                    <label class="label" style="margin-right:auto">
                        <span class="title">
                            <i class="fa fa-paper-plane" aria-hidden="true"></i>

                        </span>
                        <input class="invisible" type="submit">
                    </label>
                    <input style="width:1%;" class="invisible" type="text" value="{{note.id}}" name="form" id="form">
                </form>
            </div>
            {%endif%}
        </div>
        {%endfor%}

        {%else%}<!Закрытый аккаунт>
        <div class="block">
            <div style="display:flex; flex-direction:column">
                <label style="font-size:30px; color:#828282;">
                    <i class="fa fa-lock" aria-hidden="true"></i>
                </label>
                <span>
                        <b>This is a private profile</b>
                    </span>

                <span style="margin-top:10px;">
                        Add {{user.first_name}} as friend to watch her posts, photos and other materials
                    </span>
            </div>

        </div>

        {%endif%}


    </div>
</div>
{%endblock%}
</body>
</html>